<div *ngIf="code" class="fx-row-start-stretch fx-gap-5">
  <div class="fx-column-start-stretch fx-flex-fill">
    <code-header (codeDataChanged)="setCodeChanged()" [enableSwitchNull]="false"
                 [code]="code" [allCodes]="allCodes"></code-header>
    <div class="fx-row-start-start fx-flex-fill">
      <div class="has-rules-warning">
        <p *ngIf="elseCodeExists && code.manualInstruction"
           matTooltip="Es gibt Instruktionen fÃ¼r das manuelle Kodieren, die unwirksam sind (automatische Kodierung von unbekannten Antworten).">!!</p>
      </div>
      <mat-card class="fx-flex-fill" [style.padding-left.px]="4">
        <mat-card-subtitle>{{'code.prompt-auto-coding' | translate}}</mat-card-subtitle>
        <mat-card-content class="fx-row-start-center">
          <div *ngFor="let rule of firstRuleSet?.rules" class="fx-row-start-center fx-flex-fill">
            <div class="fx-flex-fill fx-column-start-stretch">
              <div [matTooltip]="('rule.' + rule.method + '.description') | translate"
                   matTooltipShowDelay="500">
                {{('rule.' + rule.method) | translate}}
                <span *ngIf="rule.method === 'MATCH' || rule.method === 'MATCH_REGEX'" class="multiline-text">
                  Mehrzeilig: Neues ODER-Wort in neue Zeile schreiben
                </span>
              </div>
              <mat-form-field *ngIf="rule.method === 'MATCH' || rule.method === 'MATCH_REGEX'">
                <textarea matInput *ngIf="rule.parameters"
                          [(ngModel)]="rule.parameters[0]"
                          (ngModelChange)="setCodeChanged()"
                          cdkTextareaAutosize
                          cdkAutosizeMinRows="2"
                          cdkAutosizeMaxRows="8"></textarea>
              </mat-form-field>
            </div>
            <button mat-icon-button [matTooltip]="'rule.prompt.delete' | translate" (click)="deleteRule(rule.method)"
                    *ngIf="firstRuleSet && firstRuleSet.rules.length > 1">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
          <div class="fx-row-start-center" *ngIf="canAddNewRule()">
            <button mat-icon-button (click)="addRule()"
                    [matTooltip]="'rule.prompt.add' | translate">
              <mat-icon>add</mat-icon>
            </button>
            <p *ngIf="firstRuleSet?.ruleOperatorAnd">{{'rule.info-choice-operator' | translate}}</p>
            <p *ngIf="!firstRuleSet?.ruleOperatorAnd">{{'rule.info-choice-operator-error' | translate}}</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
  <mat-card class="" [style.padding-left.px]="4" *ngIf="!elseCodeExists" [style.width.%]="50">
    <p>{{'code.prompt.add-else' | translate}}</p>
  </mat-card>
</div>
